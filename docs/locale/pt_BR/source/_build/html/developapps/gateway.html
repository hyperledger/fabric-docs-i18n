

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>&lt;no title&gt; &mdash; hyperledger-fabricdocs master documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tutorials" href="../tutorials.html" />
    <link rel="prev" title="&lt;no title&gt;" href="wallet.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          


          
            <a href="../index.html" class="icon icon-home"> hyperledger-fabricdocs
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          

<br><img style="background-color: #fff; height: unset; width: unset;" alt="Hyperledger Fabric" src=../_images/hyperledger_fabric_logo_color.png />
<br>
<a href="https://github.com/hyperledger/fabric"><img style="padding: 0px; margin: auto auto auto auto;" alt="GitHub" src="../_static/images/github_button.png"/></a>
&nbsp;<a href="https://stackoverflow.com/questions/tagged/hyperledger-fabric"><img style="padding: 0px; margin: auto auto auto auto;" alt="StackOverflow" src="../_static/images/stackoverflow_button.png"/></a>
&nbsp;<a href="https://chat.hyperledger.org"><img style="padding: 0px; margin: auto auto auto auto;" alt="Rocket Chat" src="../_static/images/rocketchat_button.png"/></a>
&nbsp;<a href="https://www.youtube.com/playlist?list=PL0MZ85B_96CH7wvtrRzV7SvtRY0sI0DEg"><img style="padding: 0px; margin: auto auto auto auto;" alt="Youtube Channel" src="../_static/images/youtube_button.png"/></a>

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew.html">What’s new in Hyperledger Fabric v2.x</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew.html#release-notes">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../key_concepts.html">Principais Conceitos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="developing_applications.html">Developing Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment_guide_overview.html">Deploying a production network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ops_guide.html">Operations Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrade.html">Upgrading to the latest release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_ref.html">Commands Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Architecture Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Fabric-FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributions Welcome!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../questions.html">Still Have Questions?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../status.html">Status</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hyperledger-fabricdocs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="developing_applications.html">Developing Applications</a> &raquo;</li>
        
          <li><a href="designelements.html">Application design elements</a> &raquo;</li>
        
      <li>&lt;no title&gt;</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/developapps/gateway.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p># Gateway</p>
<p><strong>Audience</strong>: Architects, application and smart contract developers</p>
<p>A gateway manages the network interactions on behalf of an application, allowing
it to focus on business logic. Applications connect to a gateway and then all
subsequent interactions are managed using that gateway’s configuration.</p>
<p>In this topic, we’re going to cover:</p>
<ul class="simple">
<li><p>[Why gateways are important](#scenario)</p></li>
<li><p>[How applications use a gateway](#connect)</p></li>
<li><p>[How to define a static gateway](#static)</p></li>
<li><p>[How to define a dynamic gateway for service discovery](#dynamic)</p></li>
<li><p>[Using multiple gateways](#multiple-gateways)</p></li>
</ul>
<p>## Scenario</p>
<p>A Hyperledger Fabric network channel can constantly change.  The peer, orderer
and CA components, contributed by the different organizations in the network,
will come and go. Reasons for this include increased or reduced business demand,
and both planned and unplanned outages. A gateway relieves an application of
this burden, allowing it to focus on the business problem it is trying to solve.</p>
<p>![gateway.scenario](./develop.diagram.25.png) <em>A MagnetoCorp and DigiBank
applications (issue and buy) delegate their respective network interactions to
their gateways. Each gateway understands the network channel topology comprising
the multiple peers and orderers of two organizations MagnetoCorp and DigiBank,
leaving applications to focus on business logic. Peers can talk to each other
both within and across organizations using the gossip protocol.</em></p>
<p>A gateway can be used by an application in two different ways:</p>
<ul>
<li><p><strong>Static</strong>: The gateway configuration is <em>completely</em> defined in a [connection
profile](./connectionprofile.html). All the peers, orderers and CAs
available to an application are statically defined in the connection profile
used to configure the gateway. For peers, this includes their role as an
endorsing peer or event notification hub, for example. You can read more about
these roles in the connection profile [topic](./connectionprofile.html).</p>
<p>The SDK will use this static topology, in conjunction with gateway
[connection options](./connectionoptions), to manage the transaction
submission and notification processes. The connection profile must contain
enough of the network topology to allow a gateway to interact with the
network on behalf of the application; this includes the network channels,
organizations, orderers, peers and their roles.</p>
</li>
<li><p><strong>Dynamic</strong>: The gateway configuration is minimally defined in a connection
profile. Typically, one or two peers from the application’s organization are
specified, and they use [service discovery](../discovery-overview.html) to
discover the available network topology. This includes peers, orderers,
channels, deployed smart contracts and their endorsement policies. (In
production environments, a gateway configuration should specify at least two
peers for availability.)</p>
<p>The SDK will use all of the static and discovered topology information, in
conjunction with gateway connection options, to manage the transaction
submission and notification processes. As part of this, it will also
intelligently use the discovered topology; for example, it will <em>calculate</em>
the minimum required endorsing peers using the discovered endorsement policy
for the smart contract.</p>
</li>
</ul>
<p>You might ask yourself whether a static or dynamic gateway is better? The
trade-off is between predictability and responsiveness. Static networks will
always behave the same way, as they perceive the network as unchanging. In this
sense they are predictable – they will always use the same peers and orderers
if they are available. Dynamic networks are more responsive as they understand
how the network changes – they can use newly added peers and orderers, which
brings extra resilience and scalability, at potentially some cost in
predictability. In general it’s fine to use dynamic networks, and indeed this
the default mode for gateways.</p>
<p>Note that the <em>same</em> connection profile can be used statically or dynamically.
Clearly, if a profile is going to be used statically, it needs to be
comprehensive, whereas dynamic usage requires only sparse population.</p>
<p>Both styles of gateway are transparent to the application; the application
program design does not change whether static or dynamic gateways are used. This
also means that some applications may use service discovery, while others may
not. In general using dynamic discovery means less definition and more
intelligence by the SDK; it is the default.</p>
<p>## Connect</p>
<p>When an application connects to a gateway, two options are provided. These are
used in subsequent SDK processing:</p>
<dl class="simple">
<dt><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>javascript</dt><dd><p>await gateway.connect(connectionProfile, connectionOptions);</p>
</dd>
</dl>
<p><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<ul>
<li><p><strong>Connection profile</strong>: <cite>connectionProfile</cite> is the gateway configuration that
will be used for transaction processing by the SDK, whether statically or
dynamically. It can be specified in YAML or JSON, though it must be converted
to a JSON object when passed to the gateway:</p>
<p><code class="docutils literal notranslate"><span class="pre">`javascript</span>
<span class="pre">let</span> <span class="pre">connectionProfile</span> <span class="pre">=</span> <span class="pre">yaml.safeLoad(fs.readFileSync('../gateway/paperNet.yaml',</span> <span class="pre">'utf8'));</span>
<span class="pre">`</span></code></p>
<p>Read more about [connection profiles](./connectionprofile.html) and how
to configure them.</p>
</li>
<li><p><strong>Connection options</strong>: <cite>connectionOptions</cite> allow an application to declare
rather than implement desired transaction processing behaviour. Connection
options are interpreted by the SDK to control interaction patterns with
network components, for example to select which identity to connect with, or
which peers to use for event notifications. These options significantly reduce
application complexity without compromising functionality. This is possible
because the SDK has implemented much of the low level logic that would
otherwise be required by applications; connection options control this logic
flow.</p>
<p>Read about the list of available [connection options](./connectionoptions.html)
and when to use them.</p>
</li>
</ul>
<p>## Static</p>
<p>Static gateways define a fixed view of a network. In the MagnetoCorp
[scenario](#scenario), a gateway might identify a single peer from MagnetoCorp,
a single peer from DigiBank, and a MagentoCorp orderer. Alternatively, a gateway
might define <em>all</em> peers and orderers from MagnetCorp and DigiBank. In both
cases, a gateway must define a view of the network sufficient to get commercial
paper transactions endorsed and distributed.</p>
<p>Applications can use a gateway statically by explicitly specifying the connect
option <cite>discovery: { enabled:false }</cite> on the <cite>gateway.connect()</cite> API.
Alternatively, the environment variable setting <cite>FABRIC_SDK_DISCOVERY=false</cite>
will always override the application choice.</p>
<p>Examine the [connection
profile](<a class="reference external" href="https://github.com/hyperledger/fabric-samples/blob/master/commercial-paper/organization/magnetocorp/gateway/networkConnection.yaml">https://github.com/hyperledger/fabric-samples/blob/master/commercial-paper/organization/magnetocorp/gateway/networkConnection.yaml</a>)
used by the MagnetoCorp issue application. See how all the peers, orderers and
even CAs are specified in this file, including their roles.</p>
<p>It’s worth bearing in mind that a static gateway represents a view of a network
at a <em>moment in time</em>.  As networks change, it may be important to reflect this
in a change to the gateway file. Applications will automatically pick up these
changes when they re-load the gateway file.</p>
<p>## Dynamic</p>
<p>Dynamic gateways define a small, fixed <em>starting point</em> for a network. In the
MagnetoCorp [scenario](#scenario), a dynamic gateway might identify just a
single peer from MagnetoCorp; everything else will be discovered! (To provide
resiliency, it might be better to define two such bootstrap peers.)</p>
<p>If [service discovery](../discovery-overview.html) is selected by an
application, the topology defined in the gateway file is augmented with that
produced by this process. Service discovery starts with the gateway definition,
and finds all the connected peers and orderers within the MagnetoCorp
organization using the [gossip protocol](../gossip.html). If [anchor
peers](../glossary.html#anchor-peer) have been defined for a channel, then
service discovery will use the gossip protocol across organizations to discover
components within the connected organization. This process will also discover
smart contracts installed on peers and their endorsement policies defined at a
channel level. As with static gateways, the discovered network must be
sufficient to get commercial paper transactions endorsed and distributed.</p>
<p>Dynamic gateways are the default setting for Fabric applications. They can be
explicitly specified using the connect option <cite>discovery: { enabled:true }</cite> on
the <cite>gateway.connect()</cite> API. Alternatively, the environment variable setting
<cite>FABRIC_SDK_DISCOVERY=true</cite> will always override the application choice.</p>
<p>A dynamic gateway represents an up-to-date view of a network. As networks
change, service discovery will ensure that the network view is an accurate
reflection of the topology visible to the application. Applications will
automatically pick up these changes; they do not even need to re-load the
gateway file.</p>
<p>## Multiple gateways</p>
<p>Finally, it is straightforward for an application to define multiple gateways,
both for the same or different networks. Moreover, applications can use the name
gateway both statically and dynamically.</p>
<p>It can be helpful to have multiple gateways. Here are a few reasons:</p>
<ul class="simple">
<li><p>Handling requests on behalf of different users.</p></li>
<li><p>Connecting to different networks simultaneously.</p></li>
<li><p>Testing a network configuration, by simultaneously comparing its behaviour
with an existing configuration.</p></li>
</ul>
<p>&lt;!— Licensed under Creative Commons Attribution 4.0 International License
<a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a> –&gt;</p>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../tutorials.html" class="btn btn-neutral float-right" title="Tutorials" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="wallet.html" class="btn btn-neutral" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Hyperledger 2020.
    <br>
      <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
        <img alt="Creative Commons License" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>